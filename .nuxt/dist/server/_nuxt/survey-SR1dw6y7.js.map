{"version":3,"file":"survey-SR1dw6y7.js","sources":["../../../../pages/patient/survey.vue"],"sourcesContent":["<template>\r\n  <div class=\"p-4\">\r\n    <h2 class=\"text-2xl font-bold mb-4\">Ankiety</h2>\r\n\r\n    <!-- Codzienna Ankieta -->\r\n    <div class=\"p-4 bg-white rounded shadow mb-4\">\r\n      <h3 class=\"text-xl font-bold\">Codzienna Ankieta</h3>\r\n      <p v-if=\"todaySurvey\">\r\n        Masz już wypełnioną ankietę na dzisiaj. Możesz ją edytować do końca dnia.\r\n      </p>\r\n      <p v-else>\r\n        Wypełnij ankietę, aby monitorować swoje samopoczucie.\r\n      </p>\r\n      <button @click=\"toggleForm\" class=\"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 mt-2\">\r\n        {{ todaySurvey ? 'Edytuj Ankietę' : 'Wypełnij Ankietę' }}\r\n      </button>\r\n\r\n      <div v-if=\"showForm\" class=\"mt-4\">\r\n        <form @submit.prevent=\"submitSurvey\" class=\"space-y-4\">\r\n          <!-- 1. Ocena Samopoczucia -->\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700\">Jak się dzisiaj czujesz? (1-10)</label>\r\n            <input type=\"number\" v-model.number=\"surveyForm.moodScore\" min=\"1\" max=\"10\"\r\n                   class=\"w-full border rounded px-2 py-1\" required />\r\n          </div>\r\n          <!-- 2. Czynniki Wpływające na Nastrój -->\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700\">Co miało wpływ na Twój nastrój?</label>\r\n            <div class=\"flex flex-wrap gap-2\">\r\n              <label v-for=\"factor in availableFactors\" :key=\"factor\" class=\"inline-flex items-center\">\r\n                <input type=\"checkbox\" :value=\"factor\" v-model=\"surveyForm.moodInfluencingFactors\" class=\"mr-1\" />\r\n                <span>{{ factor }}</span>\r\n              </label>\r\n            </div>\r\n            <input type=\"text\" v-model=\"surveyForm.customFactor\" placeholder=\"Inny czynnik\"\r\n                   class=\"w-full border rounded px-2 py-1 mt-2\" />\r\n          </div>\r\n          <!-- 3. Pozytywne i Negatywne Wydarzenia -->\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700\">Co pozytywnego wydarzyło się dzisiaj?</label>\r\n            <textarea v-model=\"surveyForm.positiveEvents\" class=\"w-full border rounded px-2 py-1\" rows=\"2\" required></textarea>\r\n          </div>\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700\">Co negatywnego wydarzyło się dzisiaj?</label>\r\n            <textarea v-model=\"surveyForm.negativeEvents\" class=\"w-full border rounded px-2 py-1\" rows=\"2\" required></textarea>\r\n          </div>\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700\">Jaki wpływ miały te wydarzenia na Twój nastrój? (1-10)</label>\r\n            <input type=\"number\" v-model.number=\"surveyForm.eventsImpact\" min=\"1\" max=\"10\"\r\n                   class=\"w-full border rounded px-2 py-1\" required />\r\n          </div>\r\n          <!-- 4. Sekcja Farmakoterapii -->\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700\">Czy zażyłeś dzisiaj leki?</label>\r\n            <select v-model=\"surveyForm.tookMedication\" class=\"w-full border rounded px-2 py-1\">\r\n              <option :value=\"true\">Tak</option>\r\n              <option :value=\"false\">Nie</option>\r\n            </select>\r\n          </div>\r\n          <div v-if=\"!surveyForm.tookMedication\">\r\n            <label class=\"block text-sm font-medium text-gray-700\">Podaj powód niezażycia leków:</label>\r\n            <input type=\"text\" v-model=\"surveyForm.medicationNotTakenReason\" class=\"w-full border rounded px-2 py-1\" />\r\n          </div>\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700\">Czy wystąpiły efekty uboczne?</label>\r\n            <select v-model=\"surveyForm.sideEffectsOccurred\" class=\"w-full border rounded px-2 py-1\">\r\n              <option :value=\"true\">Tak</option>\r\n              <option :value=\"false\">Nie</option>\r\n            </select>\r\n          </div>\r\n          <div v-if=\"surveyForm.sideEffectsOccurred\">\r\n            <label class=\"block text-sm font-medium text-gray-700\">Opisz efekty uboczne:</label>\r\n            <textarea v-model=\"surveyForm.sideEffectsDescription\" class=\"w-full border rounded px-2 py-1\" rows=\"2\"></textarea>\r\n          </div>\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700\">Jak się czułeś po lekach? (1-10)</label>\r\n            <input type=\"number\" v-model.number=\"surveyForm.postMedicationFeeling\" min=\"1\" max=\"10\"\r\n                   class=\"w-full border rounded px-2 py-1\" required />\r\n          </div>\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700\">Czy farmakoterapia jest skuteczna?</label>\r\n            <select v-model=\"surveyForm.medicationEffectiveness\" class=\"w-full border rounded px-2 py-1\">\r\n              <option value=\"yes\">Tak</option>\r\n              <option value=\"no\">Nie</option>\r\n              <option value=\"unknown\">Nie wiem</option>\r\n            </select>\r\n          </div>\r\n          <div v-if=\"surveyForm.medicationEffectiveness === 'no'\">\r\n            <label class=\"block text-sm font-medium text-gray-700\">Podaj powód:</label>\r\n            <input type=\"text\" v-model=\"surveyForm.medicationEffectivenessReason\" class=\"w-full border rounded px-2 py-1\" />\r\n          </div>\r\n          <button type=\"submit\" class=\"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600\">\r\n            Zapisz Ankietę\r\n          </button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Historia Ankiet -->\r\n    <div class=\"p-4 bg-white rounded shadow\">\r\n      <h3 class=\"text-xl font-bold\">Historia Ankiet</h3>\r\n      <div v-if=\"surveyHistory.length === 0\">\r\n        <p>Brak zapisanych ankiet.</p>\r\n      </div>\r\n      <ul v-else class=\"space-y-2\">\r\n        <li v-for=\"survey in surveyHistory\" :key=\"survey.id\" class=\"p-2 border rounded\">\r\n          <div><strong>Data:</strong> {{ survey.date }}</div>\r\n          <div><strong>Samopoczucie:</strong> {{ survey.moodScore }}</div>\r\n          <div><strong>Czynniki:</strong> {{ survey.moodInfluencingFactors.join(', ') }}</div>\r\n          <div><strong>Pozytywne wydarzenia:</strong> {{ survey.positiveEvents }}</div>\r\n          <div><strong>Negatywne wydarzenia:</strong> {{ survey.negativeEvents }}</div>\r\n          <div><strong>Wpływ wydarzeń:</strong> {{ survey.eventsImpact }}</div>\r\n          <div><strong>Leki:</strong> {{ survey.tookMedication ? 'Tak' : 'Nie' }}</div>\r\n          <div v-if=\"!survey.tookMedication\"><strong>Powód:</strong> {{ survey.medicationNotTakenReason }}</div>\r\n          <div><strong>Efekty uboczne:</strong> {{ survey.sideEffectsOccurred ? 'Tak' : 'Nie' }}</div>\r\n          <div v-if=\"survey.sideEffectsOccurred\"><strong>Opis:</strong> {{ survey.sideEffectsDescription }}</div>\r\n          <div><strong>Po lekach:</strong> {{ survey.postMedicationFeeling }}</div>\r\n          <div><strong>Skuteczność:</strong> {{ survey.medicationEffectiveness }}</div>\r\n          <div v-if=\"survey.medicationEffectiveness === 'no'\"><strong>Powód:</strong> {{ survey.medicationEffectivenessReason }}</div>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed, onMounted } from 'vue'\r\nimport axios from 'axios'\r\n\r\ndefinePageMeta({\r\n  layout: 'patient',\r\n  middleware: 'auth',\r\n});\r\n\r\n\r\nconst showForm = ref(false)\r\n\r\nconst surveyForm = ref({\r\n  patientId: '',\r\n  moodScore: 5,\r\n  moodInfluencingFactors: [] as string[],\r\n  customFactor: '',\r\n  positiveEvents: '',\r\n  negativeEvents: '',\r\n  eventsImpact: 5,\r\n  tookMedication: true,\r\n  medicationNotTakenReason: '',\r\n  sideEffectsOccurred: false,\r\n  sideEffectsDescription: '',\r\n  postMedicationFeeling: 5,\r\n  medicationEffectiveness: 'unknown' as 'yes' | 'no' | 'unknown',\r\n  medicationEffectivenessReason: '',\r\n})\r\n\r\ninterface Survey {\r\n  patientId: string;\r\n  id: string;\r\n  date: string;\r\n  moodScore: number;\r\n  moodInfluencingFactors: string[];\r\n  positiveEvents: string;\r\n  negativeEvents: string;\r\n  eventsImpact: number;\r\n  tookMedication: boolean;\r\n  medicationNotTakenReason?: string;\r\n  sideEffectsOccurred: boolean;\r\n  sideEffectsDescription?: string;\r\n  postMedicationFeeling: number;\r\n  medicationEffectiveness: 'yes' | 'no' | 'unknown';\r\n  medicationEffectivenessReason?: string;\r\n}\r\n\r\n\r\nconst availableFactors = [\r\n  'Stres',\r\n  'Zmęczenie',\r\n  'Spotkanie z bliskimi',\r\n  'Aktywność fizyczna',\r\n  'Terapia',\r\n  'Problemy w pracy/szkole',\r\n  'Sen (za mało/za dużo)',\r\n]\r\n\r\nconst surveyHistory = ref<Survey[]>([]);\r\n\r\n\r\nasync function loadSurveys() {\r\n  const patientId = localStorage.getItem('patientId') ?? '';\r\n  try {\r\n    const response = await axios.get('http://localhost:3000/surveys', {\r\n      params: { patientId }\r\n    })\r\n    surveyHistory.value = response.data\r\n  } catch (error) {\r\n    console.error('Błąd podczas pobierania ankiet:', error)\r\n  }\r\n}\r\n\r\nconst todaySurvey = computed(() => {\r\n  const today = new Date().toISOString().slice(0, 10)\r\n  return surveyHistory.value.find(survey => survey.date === today)\r\n})\r\n\r\nfunction toggleForm() {\r\n  showForm.value = !showForm.value\r\n  if (showForm.value && todaySurvey.value) {\r\n    Object.assign(surveyForm.value, todaySurvey.value)\r\n  }\r\n}\r\nasync function submitSurvey() {\r\n  const patientId = localStorage.getItem('patientId') ?? ''\r\n  surveyForm.value.patientId = patientId\r\n\r\n  try {\r\n    if (todaySurvey.value) {\r\n      const response = await axios.patch(`http://localhost:3000/surveys/${todaySurvey.value.id}`, surveyForm.value)\r\n      console.log('Ankieta zaktualizowana:', response.data)\r\n    } else {\r\n      const response = await axios.post('http://localhost:3000/surveys', surveyForm.value)\r\n      console.log('Ankieta utworzona:', response.data)\r\n    }\r\n    await loadSurveys()\r\n    showForm.value = false\r\n  } catch (error) {\r\n    console.error('Błąd podczas zapisywania ankiety:', error)\r\n  }\r\n}\r\n\r\nonMounted(async () => {\r\n  await loadSurveys()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n</style>\r\n"],"names":[],"mappings":";;;;;;;AAuIM,UAAA,WAAW,IAAI,KAAK;AAE1B,UAAM,aAAa,IAAI;AAAA,MACrB,WAAW;AAAA,MACX,WAAW;AAAA,MACX,wBAAwB,CAAC;AAAA,MACzB,cAAc;AAAA,MACd,gBAAgB;AAAA,MAChB,gBAAgB;AAAA,MAChB,cAAc;AAAA,MACd,gBAAgB;AAAA,MAChB,0BAA0B;AAAA,MAC1B,qBAAqB;AAAA,MACrB,wBAAwB;AAAA,MACxB,uBAAuB;AAAA,MACvB,yBAAyB;AAAA,MACzB,+BAA+B;AAAA,IAAA,CAChC;AAqBD,UAAM,mBAAmB;AAAA,MACvB;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAEM,UAAA,gBAAgB,IAAc,EAAE;AAehC,UAAA,cAAc,SAAS,MAAM;AAC3B,YAAA,6BAAY,KAAK,GAAE,cAAc,MAAM,GAAG,EAAE;AAClD,aAAO,cAAc,MAAM,KAAK,CAAU,WAAA,OAAO,SAAS,KAAK;AAAA,IAAA,CAChE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}